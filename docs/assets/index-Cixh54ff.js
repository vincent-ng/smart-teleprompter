(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}})();function f(){let r=null,n="zh-CN";try{const t=window.SpeechRecognition||window.webkitSpeechRecognition;r=new t,r.continuous=!0,r.interimResults=!0,r.lang=n}catch(t){return console.error("Speech recognition not supported:",t),{startRecognition:()=>{},stopRecognition:()=>{}}}return r.onresult=t=>{const s=Array.from(t.results).map(e=>e[0].transcript).join("");console.log(s),window.dispatchEvent(new CustomEvent("speech-progress",{detail:{transcript:s}}))},{startRecognition:()=>{try{r.start()}catch(t){console.error("Error starting recognition:",t)}},stopRecognition:()=>{try{r.stop()}catch(t){console.error("Error stopping recognition:",t)}},setLanguage:t=>{n=t,r.lang=t}}}function h(){let r=null;const n=document.getElementById("text-display"),t=document.getElementById("speed");function s(){return(11-t.value)*20}function e(){n.scrollTop+=1}return{startScrolling:()=>{const o=document.getElementById("input-text").value;n.innerHTML=o,n.scrollTop=0,r=setInterval(e,s()),t.addEventListener("input",()=>{clearInterval(r),r=setInterval(e,s())})},stopScrolling:()=>{clearInterval(r)}}}function m(r,n,t=10){const s=[];let e=null,o=0;const i=[],c=r.replace(/./g,(a,u)=>/[^\w\u4e00-\u9fa5]/.test(a)?"":(i.push(u),a)),l=n.replace(/[^\w\u4e00-\u9fa5]/g,"");for(const a of l){const u=Math.min(o+t,c.length),d=c.indexOf(a,o);if(d!==-1&&d<u){const p=i[d];e&&p===i[e.end]?e.end++:(e&&s.push({start:i[e.start],end:i[e.end-1]+1}),e={start:d,end:d+1}),o=d+1}}return e&&s.push({start:i[e.start],end:i[e.end-1]+1}),s}function y(r,n){let t=[];const s=r.split(/\s+/).filter(Boolean),e=n.split(/\s+/).filter(Boolean);let o=0;for(let i=0;i<s.length;i++){const c=s[i];if(i<e.length&&c===e[i]){const l=r.indexOf(c,o);l!==-1&&(t.push({start:l,end:l+c.length}),o=l+c.length)}}return t}function E(r,n){let t="",s=0;return n.forEach(({start:e,end:o})=>{t+=r.slice(s,e),t+=`<span class="highlighted">${r.slice(e,o)}</span>`,s=o}),t+=r.slice(s),t}const g={CHARACTER:"character",WORD:"word"};function v(){const r=document.getElementById("text-display");let n="",t=g.CHARACTER;const s=document.createElement("select");s.className="strategy-toggle",s.innerHTML=`
    <option value="${g.CHARACTER}">Character Matching</option>
    <option value="${g.WORD}">Word Matching</option>
  `;const e=document.querySelector(".buttons");e.insertBefore(s,e.firstChild),s.addEventListener("change",c=>{t=c.target.value,n&&o(n)});function o(c){const l=document.getElementById("input-text").value;if(c===n)return;n=c;const a=t===g.CHARACTER?m(l,c):y(l,c),u=E(l,a);r.innerHTML=u}function i(){n="",r.innerHTML=""}return{highlightSpokenText:o,reset:i}}function S({onStart:r,onStop:n}){const t=document.getElementById("start-btn"),s=document.getElementById("stop-btn"),e=document.getElementById("input-text"),{highlightSpokenText:o,reset:i}=v();window.addEventListener("speech-progress",c=>{o(c.detail.transcript)}),t.addEventListener("click",()=>{if(!e.value.trim()){alert("Please enter some text first!");return}i(),t.disabled=!0,s.disabled=!1,e.disabled=!0,r()}),s.addEventListener("click",()=>{t.disabled=!1,s.disabled=!0,e.disabled=!1,n()})}function R(){const r=document.createElement("div");r.className="volume-indicator",document.querySelector(".controls").appendChild(r);let n,t,s;async function e(){try{const i=await navigator.mediaDevices.getUserMedia({audio:!0});n=new AudioContext,t=n.createAnalyser(),s=n.createMediaStreamSource(i),s.connect(t),t.fftSize=256,o()}catch(i){console.error("Error accessing microphone:",i)}}function o(){if(!t)return;const i=new Uint8Array(t.frequencyBinCount);t.getByteFrequencyData(i);const c=i.reduce((a,u)=>a+u)/i.length,l=Math.min(100,Math.round(c/128*100));r.style.width=`${l}%`,r.style.backgroundColor=`hsl(${120*(l/100)}, 70%, 50%)`,requestAnimationFrame(o)}return{start:e,stop:()=>{s&&(s.disconnect(),n==null||n.close())}}}function w(){const r={"zh-CN":"中文","en-US":"English"},n=document.createElement("select");n.id="language-selector",n.className="language-selector",Object.entries(r).forEach(([s,e])=>{const o=document.createElement("option");o.value=s,o.textContent=e,n.appendChild(o)});const t=document.querySelector(".buttons");return t.insertBefore(n,t.firstChild),n}document.addEventListener("DOMContentLoaded",()=>{const{startRecognition:r,stopRecognition:n,setLanguage:t}=f(),{startScrolling:s,stopScrolling:e}=h(),o=R();w().addEventListener("change",c=>{t(c.target.value)}),S({onStart:()=>{r(),s(),o.start()},onStop:()=>{n(),e(),o.stop()}})});
